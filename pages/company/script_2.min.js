page_script({init:function(){$.fn.editable.defaults.ajaxOptions={type:"POST"},$.fn.editable.defaults.type="text",$.fn.editable.defaults.pk=1,$.fn.editable.defaults.mode="inline",$.fn.editable.defaults.inputclass="form-control",$.fn.editable.defaults.url=location.href,$.fn.editable.defaults.onblur="submit",$.fn.editable.defaults.emptytext="Vide",$(".editable").editable({params:function(a){return a.for="company",a}}),$(".categories-editable").length>0&&$(".categories-editable").editable({mode:"popup",inputclass:"input-medium",params:function(a){return a.for="company",a},select2:{multiple:!0},source:JSON.parse($(".categories-editable").attr("data-available"))}),$(".seat_editable").editable({params:function(a){return a.for="seat",a}}),$(".product_editable").editable({params:function(a){return a.for="product",a}}),$(".service_editable").editable({params:function(a){return a.for="service",a}}),$(".map-canvas").each(function(){$(this).locationpicker({location:{latitude:$(this).attr("data-latitude"),longitude:$(this).attr("data-longitude")},radius:0,zoom:13,enableAutocomplete:!0,scrollwheel:!1,onchanged:function(a){$.ajax({url:location.href,type:"POST",data:{geolocation:$(this).attr("data-pk"),latitude:a.latitude,longitude:a.longitude},success:function(a){try{var b=JSON.parse(a);"success"!=b.status&&console.log(a)}catch(c){console.log(a)}},error:function(a){console.log(a)}})}})}),$(".new_service").click(function(){$.ajax({url:location.href,type:"POST",data:{new_service:!0},success:function(c){try{var e=JSON.parse(c);switch(e.status){case"success":var g=$("#new_service_template").clone();g.removeAttr("id"),g.prependTo("#services_list").show(),$("#services_list").masonry("prepended",g.show()),g.attr("data-id",e.id),$(".service_editable",g).attr("data-pk",e.id).editable({value:null,params:function(a){return a.for="service",a}}),$(".delete",g).click(function(a){d(a,this)}),$("input[type=file]",g).change(function(a){f(a,this)}),$(".price_checkbox",g).change(a),$(".rent_price_checkbox",g).change(b),$("[href='#services_list']").click(),app.scrollTo(g,-200),$($(".thumbnail",g)[0]).pulsate({color:"#399bc3",repeat:2});break;default:console.log(c)}}catch(h){console.log(c)}},error:function(a){console.log(a)}})}),$(".new_product").click(function(){$.ajax({url:location.href,type:"POST",data:{new_product:!0},success:function(d){try{var f=JSON.parse(d);switch(f.status){case"success":var g=$("#new_product_template").clone();g.removeAttr("id"),g.prependTo("#products_list").show(),$("#products_list").masonry("prepended",g.show()),g.attr("data-id",f.id),$(".product_editable",g).attr("data-pk",f.id).editable({value:null,params:function(a){return a.for="product",a}}),$(".delete",g).click(function(a){c(a,this)}),$("input[type=file]",g).change(function(a){e(a,this)}),$(".price_checkbox",g).change(a),$(".rent_price_checkbox",g).change(b),$("[href='#products_list']").click(),app.scrollTo(g,-200),$($(".thumbnail",g)[0]).pulsate({color:"#399bc3",repeat:2});break;default:console.log(d)}}catch(h){console.log(d)}},error:function(a){console.log(a)}})});var a=function(){var b=$(this).parents("p"),c=$("[data-name=price]",b),d=$(".unit",b);$(this).prop("checked")?(c.editable("enable"),d.show()):$.post(location.href,{"for":c.hasClass("product_editable")?"product":"service",pk:c.attr("data-pk"),name:"price",value:null},function(){c.editable("setValue",null).editable("submit").editable("disable"),d.hide()})},b=function(){var b=$(this).parents("p"),c=$("[data-name=rent_price]",b),d=$(".unit",b);$(this).prop("checked")?(c.editable("enable"),d.show()):$.post(location.href,{"for":c.hasClass("product_editable")?"product":"service",pk:c.attr("data-pk"),name:"rent_price",value:null},function(){c.editable("setValue",null).editable("submit").editable("disable"),d.hide()})};$(".price_checkbox").change(a),$(".rent_price_checkbox").change(b);var c=function(a,b){a.preventDefault();var c=$(b).parents(".product");$.ajax({url:location.href,type:"POST",data:{delete_product:c.attr("data-id")},success:function(a){try{var b=JSON.parse(a);switch(b.status){case"success":$("#products_list").masonry("remove",c),$("#products_list").masonry();break;default:console.log(a)}}catch(d){console.log(a)}},error:function(a){console.log(a)}})},d=function(a,b){a.preventDefault();var c=$(b).parents(".service");$.ajax({url:location.href,type:"POST",data:{delete_service:c.attr("data-id")},success:function(a){try{var b=JSON.parse(a);switch(b.status){case"success":$("#services_list").masonry("remove",c),$("#services_list").masonry();break;default:console.log(a)}}catch(d){console.log(a)}},error:function(a){console.log(a)}})};$(".service .delete").click(function(a){d(a,this)}),$(".product .delete").click(function(a){c(a,this)});var e=function(a,b){if(0!=b.files.length){var c=$(".product form"),d=new FormData(c[0]);d.append("file","product_image"),d.append("pk",$(b).parents(".product").attr("data-id")),$.ajax({url:location.href,type:"POST",data:d,enctype:"multipart/form-data",processData:!1,contentType:!1,success:function(a){"success"!=a&&console.log(a)},error:function(a){console.log(a)}})}},f=function(a,b){if(0!=b.files.length){var c=$(".service form"),d=new FormData(c[0]);d.append("file","service_image"),d.append("pk",$(b).parents(".service").attr("data-id")),$.ajax({url:location.href,type:"POST",data:d,enctype:"multipart/form-data",processData:!1,contentType:!1,success:function(a){"success"!=a&&console.log(a)},error:function(a){console.log(a)}})}};$(".service input[type=file]").change(function(a){f(a,this)}),$(".product input[type=file]").change(function(a){e(a,this)}),$(".logo input[type=file]").change(function(){if(0!=this.files.length){var b=$(".logo form"),c=new FormData(b[0]);c.append("file","logo"),$.ajax({url:location.href,type:"POST",data:c,enctype:"multipart/form-data",processData:!1,contentType:!1,success:function(a){"success"!=a&&console.log(a)},error:function(a){console.log(a)}})}}),$(".cover input[type=file]").change(function(){if(0!=this.files.length){var b=$(".cover form"),c=new FormData(b[0]);c.append("file","cover"),$.ajax({url:location.href,type:"POST",data:c,enctype:"multipart/form-data",processData:!1,contentType:!1,success:function(a){"success"!=a&&console.log(a)},error:function(a){console.log(a)}})}}),$('a[data-toggle="tab"].sp_tabs').on("shown.bs.tab",function(a){$($(a.target).attr("href")).masonry()}).trigger("shown.bs.tab")}});