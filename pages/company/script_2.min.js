page_script({init:function(){$.fn.editable.defaults.ajaxOptions={type:"POST"};$.fn.editable.defaults.type="text";$.fn.editable.defaults.pk=1;$.fn.editable.defaults.mode="inline";$.fn.editable.defaults.inputclass="form-control";$.fn.editable.defaults.url=location.href;$.fn.editable.defaults.onblur="submit";$.fn.editable.defaults.emptytext="Vide";$(".editable").editable({params:function(a){a.element="company";return a}});0<$(".categories-editable").length&&$(".categories-editable").editable({mode:"popup",
inputclass:"input-medium",params:function(a){a.element="company";return a},select2:{multiple:!0},source:JSON.parse($(".categories-editable").attr("data-available"))});$(".seat_editable").editable({params:function(a){a.element="seat";return a}});$(".product_editable").editable({mode:"popup",params:function(a){a.element="product";return a}});$(".service_editable").editable({mode:"popup",params:function(a){a.element="service";return a}});$(".map-canvas").each(function(){$(this).locationpicker({location:{latitude:$(this).attr("data-latitude"),
longitude:$(this).attr("data-longitude")},radius:0,zoom:13,enableAutocomplete:!0,scrollwheel:!1,onchanged:function(a,c,b){$.ajax({url:location.href,type:"POST",data:{geolocation:$(this).attr("data-pk"),latitude:a.latitude,longitude:a.longitude},success:function(a){try{"success"!=JSON.parse(a).status&&console.log(a)}catch(c){console.log(a)}},error:function(a){console.log(a)}})}})});$(".new_service").click(function(a){$.ajax({url:location.href,type:"POST",data:{new_service:!0},success:function(a){try{var b=
JSON.parse(a);switch(b.status){case "success":var d=$("#new_service_template").clone();d.removeAttr("id");d.prependTo("#services_list").show();d.attr("data-id",b.id);$(".service_editable",d).attr("data-pk",b.id).editable({value:null,mode:"popup",params:function(a){a.element="service";return a}});$(".delete",d).click(function(a){g(a,this)});$("input[type=file]",d).change(function(a){h(a,this)});$(".price_checkbox",d).change(e);$(".rent_price_checkbox",d).change(f);$("[href='#services_list']").click();
$($(".thumbnail",d)[0]).pulsate({color:"#399bc3",repeat:2});break;default:console.log(a)}}catch(m){console.log(a)}},error:function(a){console.log(a)}})});$(".new_product").click(function(a){$.ajax({url:location.href,type:"POST",data:{new_product:!0},success:function(a){try{var b=JSON.parse(a);switch(b.status){case "success":var d=$("#new_product_template").clone();d.removeAttr("id");d.prependTo("#products_list").show();d.attr("data-id",b.id);$(".product_editable",d).attr("data-pk",b.id).editable({value:null,
mode:"popup",params:function(a){a.element="product";return a}});$(".delete",d).click(function(a){k(a,this)});$("input[type=file]",d).change(function(a){l(a,this)});$(".price_checkbox",d).change(e);$(".rent_price_checkbox",d).change(f);$("[href='#products_list']").click();$($(".thumbnail",d)[0]).pulsate({color:"#399bc3",repeat:2});break;default:console.log(a)}}catch(m){console.log(a)}},error:function(a){console.log(a)}})});var e=function(a){a=$(this).parents("p");var c=$("[data-name=price]",a),b=$(".unit",
a);$(this).prop("checked")?(c.editable("enable"),b.show()):$.post(location.href,{element:c.hasClass("product_editable")?"product":"service",pk:c.attr("data-pk"),name:"price",value:null},function(a){c.editable("setValue",null).editable("submit").editable("disable");b.hide()})},f=function(a){a=$(this).parents("p");var c=$("[data-name=rent_price]",a),b=$(".unit",a);$(this).prop("checked")?(c.editable("enable"),b.show()):$.post(location.href,{element:c.hasClass("product_editable")?"product":"service",
pk:c.attr("data-pk"),name:"rent_price",value:null},function(a){c.editable("setValue",null).editable("submit").editable("disable");b.hide()})};$(".price_checkbox").change(e);$(".rent_price_checkbox").change(f);var k=function(a,c){a.preventDefault();var b=$(c).parents(".product");$.ajax({url:location.href,type:"POST",data:{delete_product:b.attr("data-id")},success:function(a){try{switch(JSON.parse(a).status){case "success":b.remove();break;default:console.log(a)}}catch(c){console.log(a)}},error:function(a){console.log(a)}})},
g=function(a,c){a.preventDefault();var b=$(c).parents(".service");$.ajax({url:location.href,type:"POST",data:{delete_service:b.attr("data-id")},success:function(a){try{switch(JSON.parse(a).status){case "success":b.remove();break;default:console.log(a)}}catch(c){console.log(a)}},error:function(a){console.log(a)}})};$(".service .delete").click(function(a){g(a,this)});$(".product .delete").click(function(a){k(a,this)});var l=function(a,c){if(0!=c.files.length){var b=$(".product form"),b=new FormData(b[0]);
b.append("file","product_image");b.append("pk",$(c).parents(".product").attr("data-id"));$.ajax({url:location.href,type:"POST",data:b,enctype:"multipart/form-data",processData:!1,contentType:!1,success:function(a){"success"!=a&&console.log(a)},error:function(a){console.log(a)}})}},h=function(a,c){if(0!=c.files.length){var b=$(".service form"),b=new FormData(b[0]);b.append("file","service_image");b.append("pk",$(c).parents(".service").attr("data-id"));$.ajax({url:location.href,type:"POST",data:b,enctype:"multipart/form-data",
processData:!1,contentType:!1,success:function(a){"success"!=a&&console.log(a)},error:function(a){console.log(a)}})}};$(".service input[type=file]").change(function(a){h(a,this)});$(".product input[type=file]").change(function(a){l(a,this)});$(".logo input[type=file]").change(function(a){0!=this.files.length&&(a=$(".logo form"),a=new FormData(a[0]),a.append("file","logo"),$.ajax({url:location.href,type:"POST",data:a,enctype:"multipart/form-data",processData:!1,contentType:!1,success:function(a){"success"!=
a&&console.log(a)},error:function(a){console.log(a)}}))});$(".cover input[type=file]").change(function(a){0!=this.files.length&&(a=$(".cover form"),a=new FormData(a[0]),a.append("file","cover"),$.ajax({url:location.href,type:"POST",data:a,enctype:"multipart/form-data",processData:!1,contentType:!1,success:function(a){"success"!=a&&console.log(a)},error:function(a){console.log(a)}}))})}});
