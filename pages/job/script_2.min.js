page_script({init:function(){$.fn.editable.defaults.ajaxOptions={type:"POST"};$.fn.editable.defaults.type="text";$.fn.editable.defaults.pk=1;$.fn.editable.defaults.mode="popup";$.fn.editable.defaults.inputclass="form-control";$.fn.editable.defaults.url=location.href;$.fn.editable.defaults.onblur="submit";$.fn.editable.defaults.emptytext="Vide";$(".editable").editable();if($(".categories-editable").length>0){$(".categories-editable").editable({mode:"popup",inputclass:"input-medium",select2:{multiple:true},source:JSON.parse($(".categories-editable").attr("data-available"))})}$(".portfolio_editable").editable({mode:"popup",params:function(i){i.element="portfolio";return i}});var f=[];var c=function(){var i=JSON.parse($("input[name=available_portfolio_categories]").val());Array.prototype.push.apply(i,f);return i};$(".portfolio_categories_editable").editable({mode:"popup",autotext:"always",params:function(i){i.element="portfolio";return i},source:c(),display:function(l,k){console.log(l);var i=[],j=$.fn.editableutils.itemsByValue(l,c(),"id");if(j.length){$.each(j,function(n,m){i.push($.fn.editableutils.escape(m.text))});$(this).html(i.join(", "))}else{$(this).empty()}},select2:{multiple:true,query:function(i){i.callback({results:c()})}}});$(".skill_editable").editable({params:function(i){i.element="skill";return i}});$(".cv_editable").editable({params:function(i){i.element="cv";return i}});$(".cv_item_editable").editable({params:function(i){i.element="cv_item";return i}});$(".cv_item_project_editable").editable({params:function(i){i.element="cv_item_project";return i}});$(".new_portfolio").click(function(i){$.ajax({url:location.href,type:"POST",data:{new_portfolio:true},success:function(j){try{var m=JSON.parse(j);switch(m.status){case"success":var l=$("#new_portfolio_template").clone();l.removeAttr("id");l.prependTo(".portfolio_container").show();l.attr("data-id",m.id);$(".portfolio_editable",l).attr("data-pk",m.id).editable({value:null,mode:"popup",params:function(n){n.element="portfolio";return n}});$(".portfolio_categories_editable",l).attr("data-pk",m.id).editable({value:[],mode:"popup",params:function(n){n.element="portfolio";return n},source:JSON.parse($("input[name=available_portfolio_categories]").val()),select2:{multiple:true}});$(".delete",l).click(function(n){e(n,this)});$("input[type=file]",l).change(function(n){h(n,this)});$(".price_checkbox",l).change(price_checkbox);$(".rent_price_checkbox",l).change(rent_price_checkbox);$(".fb-like",l).attr("data-href",m.url);window.fbAsyncInit();$($(".thumbnail",l)[0]).pulsate({color:"#399bc3",repeat:2});break;default:console.log(j);break}}catch(k){console.log(j)}},error:function(j){console.log(j)}})});var e=function(k,j){k.preventDefault();var i=$(j).parents(".portfolio");$.ajax({url:location.href,type:"POST",data:{delete_portfolio:i.attr("data-id")},success:function(l){try{var n=JSON.parse(l);switch(n.status){case"success":i.remove();break;default:console.log(l);break}}catch(m){console.log(l)}},error:function(l){console.log(l)}})};$(".portfolio .delete").click(function(i){e(i,this)});var h=function(l,i){if(i.files.length==0){return}var k=$(".portfolio form");var j=new FormData(k[0]);j.append("file","portfolio_image");j.append("pk",$(i).parents(".portfolio").attr("data-id"));$.ajax({url:location.href,type:"POST",data:j,enctype:"multipart/form-data",processData:false,contentType:false,success:function(m){if(m!="success"){console.log(m)}},error:function(m){console.log(m)}})};$(".portfolio input[type=file]").change(function(i){h(i,this)});$(".remove_skill").live("click",function(){var i=$(this).parents(".skill_item");$.post(location.href,{remove:"skill",pk:i.attr("data-id")},function(j){try{var l=JSON.parse(j);switch(l.status){case"success":i.remove();break;default:console.log(j);break}}catch(k){console.log(j)}})});$(".remove_cv").live("click",function(){var i=$(this).parents(".cv_item");$.post(location.href,{remove:"cv",pk:i.attr("data-id")},function(j){try{var l=JSON.parse(j);switch(l.status){case"success":i.remove();break;default:console.log(j);break}}catch(k){console.log(j)}})});$(".remove_cv_item").live("click",function(){var i=$(this).parents(".cv_item_item");$.post(location.href,{remove:"cv_item",pk:i.attr("data-id")},function(j){try{var l=JSON.parse(j);switch(l.status){case"success":i.remove();break;default:console.log(j);break}}catch(k){console.log(j)}})});$(".remove_cv_item_project").live("click",function(){var i=$(this).parents(".cv_item_project_item");$.post(location.href,{remove:"cv_item_project",pk:i.attr("data-id")},function(j){try{var l=JSON.parse(j);switch(l.status){case"success":i.remove();break;default:console.log(j);break}}catch(k){console.log(j)}})});$(".add_skill").live("click",function(){var i=$(".skill_container");$.post(location.href,{add:"skill"},function(j){try{var l=JSON.parse(j);switch(l.status){case"success":skill=$(".templates tr.skill_item").clone();skill.appendTo(i);skill.attr("data-id",l.id);$(".skill_editable",skill).attr("data-pk",l.id).editable({params:function(m){m.element="skill";return m}});break;default:console.log(j);break}}catch(k){console.log(j)}})});$(".add_cv").live("click",function(){var i=$(".cv_container");$.post(location.href,{add:"cv"},function(j){try{var m=JSON.parse(j);switch(m.status){case"success":var k=$(".templates .cv_item").clone();k.appendTo(i);k.attr("data-id",m.id);$(".cv_editable",k).attr("data-pk",m.id).editable({params:function(n){n.element="cv";return n}});break;default:console.log(j);break}}catch(l){console.log(j)}})});$(".add_cv_item").live("click",function(){var i=$(this).parents(".cv_item").children(".panel-body").children(".cv_item_container");$.post(location.href,{add:"cv_item",cv:$(this).parents("[data-id]").attr("data-id")},function(j){try{var m=JSON.parse(j);switch(m.status){case"success":var k=$(".templates .cv_item_item").clone();k.appendTo(i);k.attr("data-id",m.id);$(".cv_item_editable",k).attr("data-pk",m.id).editable({params:function(n){n.element="cv_item";return n}});break;default:console.log(j);break}}catch(l){console.log(j)}})});$(".add_cv_item_project").live("click",function(){var i=$(this).parents(".cv_item_item").children(".list-group").children(".cv_item_project_container");$.post(location.href,{add:"cv_item_project",cv_item:$(this).parents("[data-id]").attr("data-id")},function(j){try{var m=JSON.parse(j);switch(m.status){case"success":var l=$(".templates .cv_item_project_item").clone();l.appendTo(i);l.attr("data-id",m.id);$(".cv_item_project_editable",l).attr("data-pk",m.id).editable({params:function(n){n.element="cv_item_project";return n}});break;default:console.log(j);break}}catch(k){console.log(j)}})});$(".image input[type=file]").change(function(k){if(this.files.length==0){return}var j=$(".image form");var i=new FormData(j[0]);i.append("file","image");$.ajax({url:location.href,type:"POST",data:i,enctype:"multipart/form-data",processData:false,contentType:false,success:function(l){if(l!="success"){console.log(l)}},error:function(l){console.log(l)}})});var g=$(".map_container .map-canvas");var b=new google.maps.LatLng(g.attr("data-latitude"),g.attr("data-longitude"));var d={scrollwheel:false,zoom:13,center:b};var g=new google.maps.Map(g[0],d);var a=new google.maps.Marker({position:b});a.setMap(g);$("#map_modal").on("shown.bs.modal",function(i){$("#map_modal .map-canvas").each(function(){$(this).locationpicker({location:{latitude:$(this).attr("data-latitude"),longitude:$(this).attr("data-longitude")},radius:0,zoom:12,enableAutocomplete:true,scrollwheel:true,onchanged:function(l,j,k){$.ajax({url:location.href,type:"POST",data:{geolocation:$(this).attr("data-pk"),latitude:l.latitude,longitude:l.longitude},success:function(o){try{if(o=="success"){$(".map-canvas").attr("data-latitude",l.latitude);$(".map-canvas").attr("data-longitude",l.longitude);var r=$(".map_container .map-canvas");var n=new google.maps.LatLng(r.attr("data-latitude"),r.attr("data-longitude"));var p={scrollwheel:false,zoom:13,center:n};var r=new google.maps.Map(r[0],p);var m=new google.maps.Marker({position:n});m.setMap(r)}else{console.log(o)}}catch(q){console.log(o)}},error:function(m){console.log(m)}})}})})});$(".transform_shop").click(function(){if(!confirm("Etes vous sûr ?")){return false}$.post(location.href,{transform:"shop"},function(i){try{if(i=="success"){app.ajaxify(location.href)}else{console.log(i)}}catch(j){console.log(i)}})});$(".transform_company").click(function(){if(!confirm("Etes vous sûr ?")){return false}$.post(location.href,{transform:"company"},function(i){try{if(i=="success"){app.ajaxify(location.href)}else{console.log(i)}}catch(j){console.log(i)}})});$(".delete_page").click(function(){if(!confirm($(this).attr("data-confirm")+$('.profile-usertitle-name a[data-name="name"]').text())){return false}$.post(location.href,{remove_me:true},function(i){try{if(i=="success"){app.ajaxify("/account")}else{console.log(i)}}catch(j){console.log(i)}})});if($(".messages .badge").length){$(".messages").pulsate({color:"#e91e63",repeat:3})}$(".ticket .cancel_password_reset_ticket").click(function(i){$.post(location.href,{cancel_password_reset_ticket:true},function(j){try{var k=JSON.parse(j);if(k.status=="success"){$(".ticket").hide();$(".new_ticket").show();$(".ticket .token").text("")}else{console.log(j)}}catch(l){console.log(j)}})});$(".new_ticket .new_password_reset_ticket").click(function(i){$.post(location.href,{new_password_reset_ticket:true},function(j){try{var k=JSON.parse(j);if(k.status=="success"){$(".ticket .token").text(k.params.token);$(".new_ticket").hide();$(".ticket").show()}else{console.log(j)}}catch(l){console.log(j)}})});$("#add_category_form").ajaxForm({success:function(i){try{parsed=JSON.parse(i);if(parsed.status=="success"){f.push({id:parsed.params.id,text:parsed.params.text});$("#add_category_modal").modal("hide")}else{console.log(i)}}catch(j){console.log(i)}}});$("#add_category_form").on("hide.bs.modal",function(){$("#add_category_form")[0].reset()});window.fbAsyncInit()}});