page_script({init:function(){$.fn.editable.defaults.ajaxOptions={type:"POST"};$.fn.editable.defaults.type="text";$.fn.editable.defaults.pk=1;$.fn.editable.defaults.mode="popup";$.fn.editable.defaults.inputclass="form-control";$.fn.editable.defaults.url=location.href;$.fn.editable.defaults.onblur="submit";$.fn.editable.defaults.emptytext="Vide";$(".editable").editable();if($(".categories-editable").length>0){$(".categories-editable").editable({mode:"popup",inputclass:"input-medium",select2:{multiple:true},source:JSON.parse($(".categories-editable").attr("data-available"))})}$(".portfolio_editable").editable({mode:"popup",params:function(g){g.element="portfolio";return g}});$(".portfolio_categories_editable").editable({mode:"popup",params:function(g){g.element="portfolio";return g},source:JSON.parse($("input[name=available_portfolio_categories]").val()),select2:{multiple:true}});$(".skill_editable").editable({params:function(g){g.element="skill";return g}});$(".cv_editable").editable({params:function(g){g.element="cv";return g}});$(".cv_item_editable").editable({params:function(g){g.element="cv_item";return g}});$(".cv_item_project_editable").editable({params:function(g){g.element="cv_item_project";return g}});$(".new_portfolio").click(function(g){$.ajax({url:location.href,type:"POST",data:{new_portfolio:true},success:function(h){try{var k=JSON.parse(h);switch(k.status){case"success":var j=$("#new_portfolio_template").clone();j.removeAttr("id");j.prependTo(".portfolio_container").show();j.attr("data-id",k.id);$(".portfolio_editable",j).attr("data-pk",k.id).editable({value:null,mode:"popup",params:function(l){l.element="portfolio";return l}});$(".portfolio_categories_editable",j).attr("data-pk",k.id).editable({value:[],mode:"popup",params:function(l){l.element="portfolio";return l},source:JSON.parse($("input[name=available_portfolio_categories]").val()),select2:{multiple:true}});$(".delete",j).click(function(l){d(l,this)});$("input[type=file]",j).change(function(l){f(l,this)});$(".price_checkbox",j).change(price_checkbox);$(".rent_price_checkbox",j).change(rent_price_checkbox);$(".fb-like",j).attr("data-href",k.url);window.fbAsyncInit();$($(".thumbnail",j)[0]).pulsate({color:"#399bc3",repeat:2});break;default:console.log(h);break}}catch(i){console.log(h)}},error:function(h){console.log(h)}})});var d=function(i,h){i.preventDefault();var g=$(h).parents(".portfolio");$.ajax({url:location.href,type:"POST",data:{delete_portfolio:g.attr("data-id")},success:function(j){try{var l=JSON.parse(j);switch(l.status){case"success":g.remove();break;default:console.log(j);break}}catch(k){console.log(j)}},error:function(j){console.log(j)}})};$(".portfolio .delete").click(function(g){d(g,this)});var f=function(j,g){if(g.files.length==0){return}var i=$(".portfolio form");var h=new FormData(i[0]);h.append("file","portfolio_image");h.append("pk",$(g).parents(".portfolio").attr("data-id"));$.ajax({url:location.href,type:"POST",data:h,enctype:"multipart/form-data",processData:false,contentType:false,success:function(k){if(k!="success"){console.log(k)}},error:function(k){console.log(k)}})};$(".portfolio input[type=file]").change(function(g){f(g,this)});$(".remove_skill").live("click",function(){var g=$(this).parents(".skill_item");$.post(location.href,{remove:"skill",pk:g.attr("data-id")},function(h){try{var j=JSON.parse(h);switch(j.status){case"success":g.remove();break;default:console.log(h);break}}catch(i){console.log(h)}})});$(".remove_cv").live("click",function(){var g=$(this).parents(".cv_item");$.post(location.href,{remove:"cv",pk:g.attr("data-id")},function(h){try{var j=JSON.parse(h);switch(j.status){case"success":g.remove();break;default:console.log(h);break}}catch(i){console.log(h)}})});$(".remove_cv_item").live("click",function(){var g=$(this).parents(".cv_item_item");$.post(location.href,{remove:"cv_item",pk:g.attr("data-id")},function(h){try{var j=JSON.parse(h);switch(j.status){case"success":g.remove();break;default:console.log(h);break}}catch(i){console.log(h)}})});$(".remove_cv_item_project").live("click",function(){var g=$(this).parents(".cv_item_project_item");$.post(location.href,{remove:"cv_item_project",pk:g.attr("data-id")},function(h){try{var j=JSON.parse(h);switch(j.status){case"success":g.remove();break;default:console.log(h);break}}catch(i){console.log(h)}})});$(".add_skill").live("click",function(){var g=$(".skill_container");$.post(location.href,{add:"skill"},function(h){try{var j=JSON.parse(h);switch(j.status){case"success":skill=$(".templates tr.skill_item").clone();skill.appendTo(g);skill.attr("data-id",j.id);$(".skill_editable",skill).attr("data-pk",j.id).editable({params:function(k){k.element="skill";return k}});break;default:console.log(h);break}}catch(i){console.log(h)}})});$(".add_cv").live("click",function(){var g=$(".cv_container");$.post(location.href,{add:"cv"},function(h){try{var k=JSON.parse(h);switch(k.status){case"success":var i=$(".templates .cv_item").clone();i.appendTo(g);i.attr("data-id",k.id);$(".cv_editable",i).attr("data-pk",k.id).editable({params:function(l){l.element="cv";return l}});break;default:console.log(h);break}}catch(j){console.log(h)}})});$(".add_cv_item").live("click",function(){var g=$(this).parents(".cv_item").children(".panel-body").children(".cv_item_container");$.post(location.href,{add:"cv_item",cv:$(this).parents("[data-id]").attr("data-id")},function(h){try{var k=JSON.parse(h);switch(k.status){case"success":var i=$(".templates .cv_item_item").clone();i.appendTo(g);i.attr("data-id",k.id);$(".cv_item_editable",i).attr("data-pk",k.id).editable({params:function(l){l.element="cv_item";return l}});break;default:console.log(h);break}}catch(j){console.log(h)}})});$(".add_cv_item_project").live("click",function(){var g=$(this).parents(".cv_item_item").children(".list-group").children(".cv_item_project_container");$.post(location.href,{add:"cv_item_project",cv_item:$(this).parents("[data-id]").attr("data-id")},function(h){try{var k=JSON.parse(h);switch(k.status){case"success":var j=$(".templates .cv_item_project_item").clone();j.appendTo(g);j.attr("data-id",k.id);$(".cv_item_project_editable",j).attr("data-pk",k.id).editable({params:function(l){l.element="cv_item_project";return l}});break;default:console.log(h);break}}catch(i){console.log(h)}})});$(".image input[type=file]").change(function(i){if(this.files.length==0){return}var h=$(".image form");var g=new FormData(h[0]);g.append("file","image");$.ajax({url:location.href,type:"POST",data:g,enctype:"multipart/form-data",processData:false,contentType:false,success:function(j){if(j!="success"){console.log(j)}},error:function(j){console.log(j)}})});var e=$(".map_container .map-canvas");var b=new google.maps.LatLng(e.attr("data-latitude"),e.attr("data-longitude"));var c={scrollwheel:false,zoom:13,center:b};var e=new google.maps.Map(e[0],c);var a=new google.maps.Marker({position:b});a.setMap(e);$("#map_modal").on("shown.bs.modal",function(g){$("#map_modal .map-canvas").each(function(){$(this).locationpicker({location:{latitude:$(this).attr("data-latitude"),longitude:$(this).attr("data-longitude")},radius:0,zoom:12,enableAutocomplete:true,scrollwheel:true,onchanged:function(j,h,i){$.ajax({url:location.href,type:"POST",data:{geolocation:$(this).attr("data-pk"),latitude:j.latitude,longitude:j.longitude},success:function(m){try{if(m=="success"){$(".map-canvas").attr("data-latitude",j.latitude);$(".map-canvas").attr("data-longitude",j.longitude);var p=$(".map_container .map-canvas");var l=new google.maps.LatLng(p.attr("data-latitude"),p.attr("data-longitude"));var n={scrollwheel:false,zoom:13,center:l};var p=new google.maps.Map(p[0],n);var k=new google.maps.Marker({position:l});k.setMap(p)}else{console.log(m)}}catch(o){console.log(m)}},error:function(k){console.log(k)}})}})})});window.fbAsyncInit()}});