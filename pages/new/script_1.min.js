page_script({init:function(){var g=$("#title"+$("input[name=type]:checked").val()+" form");$("input[name=type]").change(function(){switch($("input[name=type]:checked").val()){case "1":$('a[href="#title1"]').tab("show");g=$("#title1 form");var a=$("#job_geolocation").locationpicker("map");google.maps.event.trigger(a.map,"resize");a.map.setCenter(a.marker.position);break;case "3":$('a[href="#title3"]').tab("show"),g=$("#title3 form"),a=$("#company_geolocation").locationpicker("map"),google.maps.event.trigger(a.map,
"resize"),a.map.setCenter(a.marker.position)}});$("#register_form input[name=username]").change(function(){var a=$(this);$(".icon-check, .icon-ban, .icon-close",a.closest(".form-group")).remove();""===a.val()?a.closest(".form-group").removeClass("has-error").removeClass("has-success"):(a.attr("readonly",!0).attr("disabled",!0).addClass("spinner"),$("#username_unvailable_msg").hide(),$("#username_error_msg").hide(),$.post($("#register_form input").attr("action"),{check_username:a.val()},function(b){a.attr("readonly",
!1).attr("disabled",!1).removeClass("spinner");"available"==b.status?($(".icon-ban",a.closest(".form-group")).remove(),a.closest(".form-group").removeClass("has-error").removeClass("has-success")):"not_available"==b.status?(a.closest(".form-group").removeClass("has-success").addClass("has-error"),$(".fa-check",a.closest(".form-group")).remove(),a.before('<i class="icon-ban"></i>'),$("#username_unvailable_msg").show(),a.focus()):(console.log(b),a.closest(".form-group").removeClass("has-success").addClass("has-error"),
$(".fa-check",a.closest(".form-group")).remove(),a.before('<i class="icon-close"></i>'),$("#username_error_msg").show(),$("#username_error_msg a").focus())},"json").fail(function(b){console.log(b);a.closest(".form-group").removeClass("has-success").addClass("has-error");$(".fa-check",a.closest(".form-group")).remove();a.before('<i class="icon-close"></i>');$("#username_error_msg").show();$("#username_error_msg a").focus()}))});var c=function(){var a=$("#register_form input[name=password]");8>$("#register_form input[name=password]").val().length?
(a.closest(".form-group").removeClass("has-success").addClass("has-error"),$(".fa-check",a.closest(".form-group")).remove(),a.before('<i class="icon-ban"></i>'),$("#password_min_length_error").show(),a.focus()):($(".icon-ban",a.closest(".form-group")).remove(),a.closest(".form-group").removeClass("has-error").removeClass("has-success"),$("#password_min_length_error").hide());a=$("#password_confirmation");""==$("#password_confirmation").val()||$("#password_confirmation").val()==$("#register_form input[name=password]").val()?
($(".icon-ban",a.closest(".form-group")).remove(),a.closest(".form-group").removeClass("has-error").removeClass("has-success"),$("#passwords_not_match").hide()):(a.closest(".form-group").removeClass("has-success").addClass("has-error"),$(".fa-check",$("#password_confirmation").closest(".form-group")).remove(),a.before('<i class="icon-ban"></i>'),$("#passwords_not_match").show(),$("#password_confirmation").focus())};$("#register_form input[name=password]").change(c);$("#password_confirmation").change(c);
$("#register_form").ajaxForm({beforeSubmit:function(){if($("#password_confirmation").val()!=$("#register_form input[name=password]").val())return!1},success:function(a){try{if(parsed=JSON.parse(a),"logged_in"==parsed.status)$(".top-menu .user-btn .username").text(parsed.params.displayname),$(".top-menu .login-btn").hide(),$(".top-menu .user-btn").show(),g.submit();else if("username_exists"==parsed.status){var b=$("#register_form input[name=username]");b.closest(".form-group").removeClass("has-success").addClass("has-error");
$(".fa-check",b.closest(".form-group")).remove();b.before('<i class="icon-ban"></i>');$("#username_unvailable_msg").show();b.focus()}else"password_min_length_error"==parsed.status?(b=$("#register_form input[name=password]"),b.closest(".form-group").removeClass("has-success").addClass("has-error"),$(".fa-check",b.closest(".form-group")).remove(),b.before('<i class="icon-ban"></i>'),$("#password_min_length_error").show(),b.focus()):(console.log(a),$(".unhandled_error").show())}catch(c){console.log(c),
console.log(a),$(".unhandled_error").show()}},error:function(){console.log(rslt);$(".unhandled_error").show()}});navigator.geolocation||(c=$("#job_find_my_position").parents(".input-group"),c.before($("input",c)),c.remove());$("#job_geolocation").locationpicker({location:{latitude:33.881967,longitude:9.560764},radius:0,zoom:6,enableAutocomplete:!0,scrollwheel:!1,inputBinding:{locationNameInput:$("#job_submit_form [name=job_address]"),latitudeInput:$("#job_submit_form [name=job_latitude]"),longitudeInput:$("#job_submit_form [name=job_longitude]")}});
$("#job_find_my_position").click(function(a){a.preventDefault();navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(a){$("#job_submit_form [name=job_latitude]").val(a.coords.latitude).change();$("#job_submit_form [name=job_longitude]").val(a.coords.longitude).change()})});var d=$("#job_submit_form"),e=$(".alert-danger.form-error");d.validate({ignore:"",errorElement:"span",errorClass:"help-block help-block-error",focusInvalid:!0,rules:{name:{minlength:3,maxlength:255,required:!0},
description:{minlength:50,maxlength:4095,required:!0},categories:{required:!0},address:{required:!0},longitude:{required:!0},latitude:{required:!0},tel:{required:!0},email:{required:!0}},invalidHandler:function(a,b){e.show()},highlight:function(a){$(a).closest(".form-group").removeClass("has-success").addClass("has-error")},unhighlight:function(a){$(a).closest(".form-group").removeClass("has-error")},success:function(a){},errorPlacement:function(a,b){switch($(b).attr("job_name")){default:a.insertAfter(b)}},
submitHandler:function(a){e.hide()}});$("[name='job_categories[]']",d).select2();d.submit(function(a){if(!d.valid())return a.preventDefault(),!1;if(a.originalEvent&&1==$("#register_form").length)return $("#register_form").submit(),a.preventDefault(),!1;$.ajax({url:$(this).attr("action"),type:"POST",data:$(d).serialize(),success:function(a){try{switch(p=JSON.parse(a),p.status){case "success":app.ajaxify(p.params.job_url);break;default:return console.log(p),!1}}catch(c){return console.log(a),!1}},error:function(a){console.log(a);
return!1}})});navigator.geolocation||(c=$("#company_find_my_position").parents(".input-group"),c.before($("input",c)),c.remove());$("#company_geolocation").locationpicker({location:{latitude:33.881967,longitude:9.560764},radius:0,zoom:6,enableAutocomplete:!0,scrollwheel:!1,inputBinding:{locationNameInput:$("#company_submit_form [name=company_address]"),latitudeInput:$("#company_submit_form [name=company_latitude]"),longitudeInput:$("#company_submit_form [name=company_longitude]")}});$("#company_find_my_position").click(function(a){a.preventDefault();
navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(a){$("#company_submit_form [name=company_latitude]").val(a.coords.latitude).change();$("#company_submit_form [name=company_longitude]").val(a.coords.longitude).change()})});var f=$("#company_submit_form"),e=$(".alert-danger.form-error");f.validate({ignore:"",errorElement:"span",errorClass:"help-block help-block-error",focusInvalid:!0,rules:{name:{minlength:3,maxlength:255,required:!0},description:{minlength:50,maxlength:4095,
required:!0},categories:{required:!0},url:{minlength:5,remote:{url:$("#register_form input").attr("action"),type:"post",data:{check_url:function(){return $("[name=company_url]",company_).val()}}}},address:{required:!0},longitude:{required:!0},latitude:{required:!0},tel:{required:!0},email:{required:!0}},invalidHandler:function(a,b){e.show()},highlight:function(a){$(a).closest(".form-group").removeClass("has-success").addClass("has-error")},unhighlight:function(a){$(a).closest(".form-group").removeClass("has-error")},
success:function(a){},errorPlacement:function(a,b){switch($(b).attr("company_name")){case "url":a.appendTo($(b.parents(".form-group")[0]).find(".error_msg"));break;default:a.insertAfter(b)}},submitHandler:function(a){e.hide()}});$("[name='company_categories[]']",f).select2();f.submit(function(a){if(!f.valid())return a.preventDefault(),!1;if(a.originalEvent&&1==$("#register_form").length)return $("#register_form").submit(),a.preventDefault(),!1;$.ajax({url:$(this).attr("action"),type:"POST",data:$(f).serialize(),
success:function(a){try{switch(p=JSON.parse(a),p.status){case "success":app.ajaify(p.params.company_url);break;default:return console.log(p),!1}}catch(c){return console.log(a),!1}},error:function(a){console.log(a);return!1}})});$("#register_form input[name=displayname]").focus()}});
