page_script({init:function(){if(!navigator.geolocation){var a=$("#find_my_position").parents(".input-group");a.before($("input",a)),a.remove()}$("#geolocation").locationpicker({location:{latitude:33.881967,longitude:9.560764},radius:0,zoom:6,enableAutocomplete:!0,scrollwheel:!1,inputBinding:{locationNameInput:$("#submit_form [name=address]"),latitudeInput:$("#submit_form [name=latitude]"),longitudeInput:$("#submit_form [name=longitude]")}}),$("#find_my_position").click(function(a){a.preventDefault(),navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(a){$("#submit_form [name=latitude]").val(a.coords.latitude).change(),$("#submit_form [name=longitude]").val(a.coords.longitude).change()})});var b=$("#submit_form"),c=$(".alert-danger.form-error",b);b.validate({ignore:"",errorElement:"span",errorClass:"help-block help-block-error",focusInvalid:!0,rules:{name:{minlength:3,maxlength:255,required:!0},description:{minlength:50,maxlength:4095,required:!0},categories:{required:!0},url:{minlength:5,remote:{url:location.href,type:"post",data:{check_url:function(){return $("[name=url]",b).val()}}}},address:{required:!0},longitude:{required:!0},latitude:{required:!0},tel:{required:!0},email:{required:!0}},invalidHandler:function(){c.show()},highlight:function(a){$(a).closest(".form-group").removeClass("has-success").addClass("has-error")},unhighlight:function(a){$(a).closest(".form-group").removeClass("has-error")},success:function(){},errorPlacement:function(a,b){switch($(b).attr("name")){case"url":a.appendTo($(b.parents(".form-group")[0]).find(".error_msg"));break;default:a.insertAfter(b)}},submitHandler:function(){c.hide()}}),$("[name='categories[]']",b).select2(),b.submit(function(a){return b.valid()?(app.blockUI({iconOnly:!0,animate:!0}),$.ajax({url:location.href,type:"POST",data:$(b).serialize(),success:function(a){app.unblockUI();try{switch(p=JSON.parse(a),p.status){case"success":$("#success_msg .goto_company").attr("href",p.params.company_url),$("#page_wizard").remove(),$("#success_msg").show();break;default:return console.log(p),!1}}catch(b){return console.log(a),!1}},error:function(a){return app.unblockUI(),console.log(a),!1}}),void 0):(a.preventDefault(),!1)}),$("[name=name]",b).focus()}});