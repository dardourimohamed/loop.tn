page_script({init:function(){$("#register_form input[name=displayname]").focus(),$("#register_form input[name=username]").change(function(){var a=$(this);return $(".icon-check, .icon-ban, .icon-close",a.closest(".form-group")).remove(),""===a.val()?(a.closest(".form-group").removeClass("has-error").removeClass("has-success"),void 0):(a.attr("readonly",!0).attr("disabled",!0).addClass("spinner"),$("#username_unvailable_msg").hide(),$("#username_error_msg").hide(),$.post(location.href,{check_username:a.val()},function(b){a.attr("readonly",!1).attr("disabled",!1).removeClass("spinner"),"available"==b.status?($(".icon-ban",a.closest(".form-group")).remove(),a.closest(".form-group").removeClass("has-error").removeClass("has-success")):"not_available"==b.status?(a.closest(".form-group").removeClass("has-success").addClass("has-error"),$(".fa-check",a.closest(".form-group")).remove(),a.before('<i class="icon-ban"></i>'),$("#username_unvailable_msg").show(),a.focus()):(console.log(b),a.closest(".form-group").removeClass("has-success").addClass("has-error"),$(".fa-check",a.closest(".form-group")).remove(),a.before('<i class="icon-close"></i>'),$("#username_error_msg").show(),$("#username_error_msg a").focus())},"json").fail(function(b){console.log(b),a.closest(".form-group").removeClass("has-success").addClass("has-error"),$(".fa-check",a.closest(".form-group")).remove(),a.before('<i class="icon-close"></i>'),$("#username_error_msg").show(),$("#username_error_msg a").focus()}),void 0)});var a=function(){var a=$("#register_form input[name=password]");$("#register_form input[name=password]").val().length<8?(a.closest(".form-group").removeClass("has-success").addClass("has-error"),$(".fa-check",a.closest(".form-group")).remove(),a.before('<i class="icon-ban"></i>'),$("#password_min_length_error").show(),a.focus()):($(".icon-ban",a.closest(".form-group")).remove(),a.closest(".form-group").removeClass("has-error").removeClass("has-success"),$("#password_min_length_error").hide());var a=$("#password_confirmation");""==$("#password_confirmation").val()||$("#password_confirmation").val()==$("#register_form input[name=password]").val()?($(".icon-ban",a.closest(".form-group")).remove(),a.closest(".form-group").removeClass("has-error").removeClass("has-success"),$("#passwords_not_match").hide()):(a.closest(".form-group").removeClass("has-success").addClass("has-error"),$(".fa-check",$("#password_confirmation").closest(".form-group")).remove(),a.before('<i class="icon-ban"></i>'),$("#passwords_not_match").show(),$("#password_confirmation").focus())};$("#register_form input[name=password]").change(a),$("#password_confirmation").change(a),$("#register_form").ajaxForm({beforeSubmit:function(){return $("#password_confirmation").val()!=$("#register_form input[name=password]").val()?!1:void 0},success:function(a){try{if(parsed=JSON.parse(a),"logged_in"==parsed.status)$(".top-menu .user-btn .username").text(parsed.params.displayname),$(".top-menu .login-btn").hide(),$(".top-menu .user-btn").show(),app.ajaxify(location.origin+"/account");else if("username_exists"==res.status){var b=$("#register_form input[name=username]");b.closest(".form-group").removeClass("has-success").addClass("has-error"),$(".fa-check",b.closest(".form-group")).remove(),b.before('<i class="icon-ban"></i>'),$("#username_unvailable_msg").show(),b.focus()}else if("password_min_length_error"==res.status){var b=$("#register_form input[name=password]");b.closest(".form-group").removeClass("has-success").addClass("has-error"),$(".fa-check",b.closest(".form-group")).remove(),b.before('<i class="icon-ban"></i>'),$("#password_min_length_error").show(),b.focus()}else console.log(a),$(".unhandled_error").show()}catch(c){console.log(a),$(".unhandled_error").show()}},error:function(){console.log(rslt),$(".unhandled_error").show()}})}});