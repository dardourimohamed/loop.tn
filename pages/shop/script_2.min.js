page_script({init:function(){$.fn.editable.defaults.ajaxOptions={type:"POST"};$.fn.editable.defaults.type="text";$.fn.editable.defaults.pk=1;$.fn.editable.defaults.mode="inline";$.fn.editable.defaults.inputclass="form-control";$.fn.editable.defaults.url=location.href;$.fn.editable.defaults.onblur="submit";$.fn.editable.defaults.emptytext="Vide";$(".editable").editable({params:function(i){i.element="shop";return i}});if($(".categories-editable").length>0){$(".categories-editable").editable({mode:"popup",inputclass:"input-medium",params:function(i){i.element="shop";return i},select2:{multiple:true},source:JSON.parse($(".categories-editable").attr("data-available"))})}$(".seat_editable").editable({params:function(i){i.element="seat";return i}});$(".product_editable").editable({mode:"popup",params:function(i){i.element="product";return i}});$(".product_categories_editable").editable({mode:"popup",params:function(i){i.element="product";return i},source:JSON.parse($("input[name=available_product_categories]").val()),select2:{multiple:true}});$(".new_product").click(function(i){$.ajax({url:location.href,type:"POST",data:{new_product:true},success:function(j){try{var m=JSON.parse(j);switch(m.status){case"success":var l=$("#new_product_template").clone();l.removeAttr("id");l.prependTo("#products_list").show();l.attr("data-id",m.id);$(".product_editable",l).attr("data-pk",m.id).editable({value:null,mode:"popup",params:function(n){n.element="product";return n}});$(".product_categories_editable",l).attr("data-pk",m.id).editable({value:[],mode:"popup",params:function(n){n.element="product";return n},source:JSON.parse($("input[name=available_product_categories]").val()),select2:{multiple:true}});$(".delete",l).click(function(n){d(n,this)});$("input[type=file]",l).change(function(n){f(n,this)});$(".price_checkbox",l).change(g);$(".rent_price_checkbox",l).change(e);$(".fb-like",l).attr("data-href",m.url);window.fbAsyncInit();$("[href='#products_list']").click();$($(".thumbnail",l)[0]).pulsate({color:"#399bc3",repeat:2});break;default:console.log(j);break}}catch(k){console.log(j)}},error:function(j){console.log(j)}})});var g=function(l){var i=$(this).parents("p");var j=$("[data-name=price]",i);var k=$(".unit",i);if($(this).prop("checked")){j.editable("enable");k.show()}else{$.post(location.href,{element:"product",pk:j.attr("data-pk"),name:"price",value:null},function(m){j.editable("setValue",null).editable("submit").editable("disable");k.hide()})}};var e=function(l){var i=$(this).parents("p");var j=$("[data-name=rent_price]",i);var k=$(".unit",i);if($(this).prop("checked")){j.editable("enable");k.show()}else{$.post(location.href,{element:"product",pk:j.attr("data-pk"),name:"rent_price",value:null},function(m){j.editable("setValue",null).editable("submit").editable("disable");k.hide()})}};$(".price_checkbox").change(g);$(".rent_price_checkbox").change(e);var d=function(k,j){k.preventDefault();var i=$(j).parents(".product");$.ajax({url:location.href,type:"POST",data:{delete_product:i.attr("data-id")},success:function(l){try{var n=JSON.parse(l);switch(n.status){case"success":i.remove();break;default:console.log(l);break}}catch(m){console.log(l)}},error:function(l){console.log(l)}})};$(".product .delete").click(function(i){d(i,this)});var f=function(l,i){if(i.files.length==0){return}var k=$(".product form");var j=new FormData(k[0]);j.append("file","product_image");j.append("pk",$(i).parents(".product").attr("data-id"));$.ajax({url:location.href,type:"POST",data:j,enctype:"multipart/form-data",processData:false,contentType:false,success:function(m){if(m!="success"){console.log(m)}},error:function(m){console.log(m)}})};$(".product input[type=file]").change(function(i){f(i,this)});$(".image input[type=file]").change(function(k){if(this.files.length==0){return}var j=$(".image form");var i=new FormData(j[0]);i.append("file","image");$.ajax({url:location.href,type:"POST",data:i,enctype:"multipart/form-data",processData:false,contentType:false,success:function(l){if(l!="success"){console.log(l)}},error:function(l){console.log(l)}})});$(".cover input[type=file]").change(function(k){if(this.files.length==0){return}var j=$(".cover form");var i=new FormData(j[0]);i.append("file","cover");$.ajax({url:location.href,type:"POST",data:i,enctype:"multipart/form-data",processData:false,contentType:false,success:function(l){if(l!="success"){console.log(l)}},error:function(l){console.log(l)}})});var h=$(".map_container .map-canvas");var b=new google.maps.LatLng(h.attr("data-latitude"),h.attr("data-longitude"));var c={scrollwheel:false,zoom:13,center:b};var h=new google.maps.Map(h[0],c);var a=new google.maps.Marker({position:b});a.setMap(h);$("#map_modal").on("shown.bs.modal",function(i){$("#map_modal .map-canvas").each(function(){$(this).locationpicker({location:{latitude:$(this).attr("data-latitude"),longitude:$(this).attr("data-longitude")},radius:0,zoom:12,enableAutocomplete:true,scrollwheel:true,onchanged:function(l,j,k){$.ajax({url:location.href,type:"POST",data:{geolocation:$(this).attr("data-pk"),latitude:l.latitude,longitude:l.longitude},success:function(o){try{if(o=="success"){$(".map-canvas").attr("data-latitude",l.latitude);$(".map-canvas").attr("data-longitude",l.longitude);var r=$(".map_container .map-canvas");var n=new google.maps.LatLng(r.attr("data-latitude"),r.attr("data-longitude"));var p={scrollwheel:false,zoom:13,center:n};var r=new google.maps.Map(r[0],p);var m=new google.maps.Marker({position:n});m.setMap(r)}else{console.log(o)}}catch(q){console.log(o)}},error:function(m){console.log(m)}})}})})});$(".transform_job").click(function(){if(!confirm("Etes vous sûr ?")){return false}$.post(location.href,{transform:"job"},function(i){try{if(i=="success"){app.ajaxify(location.href)}else{console.log(i)}}catch(j){console.log(i)}})});$(".transform_company").click(function(){if(!confirm("Etes vous sûr ?")){return false}$.post(location.href,{transform:"company"},function(i){try{if(i=="success"){app.ajaxify(location.href)}else{console.log(i)}}catch(j){console.log(i)}})});$(".delete_page").click(function(){if(!confirm($(this).attr("data-confirm")+$('.profile-usertitle-name a[data-name="name"]').text())){return false}$.post(location.href,{remove_me:true},function(i){try{if(i=="success"){app.ajaxify("/account")}else{console.log(i)}}catch(j){console.log(i)}})});if($(".messages .badge").length){$(".messages").pulsate({color:"#e91e63",repeat:3})}window.fbAsyncInit()}});