page_script({init:function(){$.fn.editable.defaults.ajaxOptions={type:"POST"};$.fn.editable.defaults.type="text";$.fn.editable.defaults.pk=1;$.fn.editable.defaults.mode="inline";$.fn.editable.defaults.inputclass="form-control";$.fn.editable.defaults.url=location.href;$.fn.editable.defaults.onblur="submit";$.fn.editable.defaults.emptytext="Vide";$(".editable").editable({params:function(e){e.element="shop";return e}});if($(".categories-editable").length>0){$(".categories-editable").editable({mode:"popup",inputclass:"input-medium",params:function(e){e.element="shop";return e},select2:{multiple:true},source:JSON.parse($(".categories-editable").attr("data-available"))})}$(".seat_editable").editable({params:function(e){e.element="seat";return e}});$(".product_editable").editable({mode:"popup",params:function(e){e.element="product";return e}});$(".product_categories_editable").editable({mode:"popup",params:function(e){e.element="product";return e},source:JSON.parse($("input[name=available_product_categories]").val()),select2:{multiple:true}});$(".map-canvas").each(function(){$(this).locationpicker({location:{latitude:$(this).attr("data-latitude"),longitude:$(this).attr("data-longitude")},radius:0,zoom:13,enableAutocomplete:true,scrollwheel:false,onchanged:function(g,e,f){$.ajax({url:location.href,type:"POST",data:{geolocation:$(this).attr("data-pk"),latitude:g.latitude,longitude:g.longitude},success:function(h){try{var j=JSON.parse(h);if(j.status!="success"){console.log(h)}}catch(i){console.log(h)}},error:function(h){console.log(h)}})}})});$(".new_product").click(function(f){$.ajax({url:location.href,type:"POST",data:{new_product:true},success:function(e){try{var i=JSON.parse(e);switch(i.status){case"success":var h=$("#new_product_template").clone();h.removeAttr("id");h.prependTo("#products_list").show();h.attr("data-id",i.id);$(".product_editable",h).attr("data-pk",i.id).editable({value:null,mode:"popup",params:function(j){j.element="product";return j}});$(".product_categories_editable",h).attr("data-pk",i.id).editable({value:[],mode:"popup",params:function(j){j.element="product";return j},source:JSON.parse($("input[name=available_product_categories]").val()),select2:{multiple:true}});$(".delete",h).click(function(j){a(j,this)});$("input[type=file]",h).change(function(j){c(j,this)});$(".price_checkbox",h).change(d);$(".rent_price_checkbox",h).change(b);$(".fb-like",h).attr("data-href",i.url);window.fbAsyncInit();$("[href='#products_list']").click();$($(".thumbnail",h)[0]).pulsate({color:"#399bc3",repeat:2});break;default:console.log(e);break}}catch(g){console.log(e)}},error:function(e){console.log(e)}})});var d=function(i){var f=$(this).parents("p");var g=$("[data-name=price]",f);var h=$(".unit",f);if($(this).prop("checked")){g.editable("enable");h.show()}else{$.post(location.href,{element:"product",pk:g.attr("data-pk"),name:"price",value:null},function(e){g.editable("setValue",null).editable("submit").editable("disable");h.hide()})}};var b=function(i){var f=$(this).parents("p");var g=$("[data-name=rent_price]",f);var h=$(".unit",f);if($(this).prop("checked")){g.editable("enable");h.show()}else{$.post(location.href,{element:"product",pk:g.attr("data-pk"),name:"rent_price",value:null},function(e){g.editable("setValue",null).editable("submit").editable("disable");h.hide()})}};$(".price_checkbox").change(d);$(".rent_price_checkbox").change(b);var a=function(h,g){h.preventDefault();var f=$(g).parents(".product");$.ajax({url:location.href,type:"POST",data:{delete_product:f.attr("data-id")},success:function(e){try{var j=JSON.parse(e);switch(j.status){case"success":f.remove();break;default:console.log(e);break}}catch(i){console.log(e)}},error:function(e){console.log(e)}})};$(".product .delete").click(function(f){a(f,this)});var c=function(i,f){if(f.files.length==0){return}var h=$(".product form");var g=new FormData(h[0]);g.append("file","product_image");g.append("pk",$(f).parents(".product").attr("data-id"));$.ajax({url:location.href,type:"POST",data:g,enctype:"multipart/form-data",processData:false,contentType:false,success:function(e){if(e!="success"){console.log(e)}},error:function(e){console.log(e)}})};$(".product input[type=file]").change(function(f){c(f,this)});$(".image input[type=file]").change(function(h){if(this.files.length==0){return}var g=$(".image form");var f=new FormData(g[0]);f.append("file","image");$.ajax({url:location.href,type:"POST",data:f,enctype:"multipart/form-data",processData:false,contentType:false,success:function(e){if(e!="success"){console.log(e)}},error:function(e){console.log(e)}})});$(".cover input[type=file]").change(function(h){if(this.files.length==0){return}var g=$(".cover form");var f=new FormData(g[0]);f.append("file","cover");$.ajax({url:location.href,type:"POST",data:f,enctype:"multipart/form-data",processData:false,contentType:false,success:function(e){if(e!="success"){console.log(e)}},error:function(e){console.log(e)}})});window.fbAsyncInit()}});